var f=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var m=(u,a)=>{var r={};for(var t in u)v.call(u,t)&&a.indexOf(t)<0&&(r[t]=u[t]);if(u!=null&&f)for(var t of f(u))a.indexOf(t)<0&&k.call(u,t)&&(r[t]=u[t]);return r};import{d as w,r as y,l as F,m as x,a as i,c as p,b as o,e as A,f as D,u as d,t as g,n as h,h as E,p as N}from"./index.886648a4.js";import{S as V,a as z}from"./index.9e83573e.js";const S={class:"bg_pattern"},j={class:"px-3 pt-4 pb-[102px] lg:mx-auto lg:flex lg:max-w-[869px] lg:px-0 lg:py-[49px]"},M={class:"lg:mr-[27px] lg:flex-grow"},G=o("h2",{class:"relative mb-4 isolate after:absolute after:right-1 after:top-1 after:z-[-1] after:h-full after:w-full after:border-2 after:border-black-100 after:content-['']"},[o("div",{class:"border-2 border-black-100 bg-white py-[18px] text-center font-azeret text-xl font-bold text-black-100"}," \u5F35\u8CBC\u52D5\u614B ")],-1),P={class:"bg-white rounded-lg border-2 border-black-100 p-8 shadow-card"},R=o("label",{for:"content",class:"mb-1 inline-block text-black-100"},"\u8CBC\u6587\u5167\u5BB9",-1),T={class:"relative inline-block rounded bg-black-100 py-1 px-8 text-white"},U=N(" \u4E0A\u50B3\u5716\u7247 "),$=["src"],J={key:1,class:"mt-8 text-center text-sm text-red-100"},H=w({setup(u){const a=y({user:F()._id,type:"person",tags:"\u8CBC\u6587 tags",content:"",file:null}),r=x(""),t=x(""),B=({target:n})=>{const{files:e}=n;if(!(e!=null&&e[0].name.match(/\.(jpg|jpeg|png)$/))){t.value="\u5716\u7247\u683C\u5F0F\u932F\u8AA4\uFF0C\u50C5\u9650 JPG\u3001PNG \u5716\u7247";return}if((e==null?void 0:e[0].size)>=10*1024**2){t.value="\u9650\u5236\u4E0A\u50B3\u6A94\u6848\u7684\u5927\u5C0F\u70BA 10 MB";return}const l=new FileReader;a.file=e==null?void 0:e[0],l.readAsDataURL(e==null?void 0:e[0]),l.onload=({target:s})=>r.value=s==null?void 0:s.result},C=async()=>{if(!a.content){t.value="\u8ACB\u8F38\u5165\u8CBC\u6587\u5167\u5BB9";return}if(!a.file){t.value="\u8ACB\u4E0A\u50B3\u5716\u7247";return}const n=new FormData,b=a,{file:e}=b,l=m(b,["file"]),s="https://gentle-refuge-37601.herokuapp.com";n.append("image",e,e.name),Object.entries(l).forEach(([c,_])=>n.append(c,_));try{await z.post(`${s}/posts`,n),a.content="",a.file=null,r.value="",alert("\u5F35\u8CBC\u52D5\u614B\u6210\u529F")}catch(c){console.log(c),alert("\u5F35\u8CBC\u52D5\u614B\u5931\u6557")}};return(n,e)=>{var l;return i(),p("div",S,[o("main",j,[o("section",M,[G,o("form",P,[R,A(o("textarea",{"onUpdate:modelValue":e[0]||(e[0]=s=>d(a).content=s),type:"text",class:"mb-4 block min-h-[169px] w-full border-2 border-black-100 py-3 px-4",placeholder:"\u8F38\u5165\u60A8\u7684\u8CBC\u6587\u5167\u5BB9"},null,512),[[D,d(a).content]]),o("label",T,[o("input",{onChange:B,type:"file",class:"sr-only"},null,32),U]),o("p",null,g((l=d(a).file)==null?void 0:l.name),1),r.value?(i(),p("img",{key:0,src:r.value,class:"mt-4"},null,8,$)):h("",!0),t.value?(i(),p("p",J,g(t.value),1)):h("",!0),o("input",{onClick:C,type:"button",class:"mx-auto mt-8 block cursor-pointer w-[68.86%] rounded-lg border-2 border-black-100 bg-gray-200 font-azeret font-bold leading-[50px] text-black-100 hover:bg-yellow-100 hover:shadow-btn",value:"\u9001\u51FA\u8CBC\u6587"})])]),E(V)])])}}});export{H as default};
